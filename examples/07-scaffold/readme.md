# Example 7: Scaffold Manifest

This example demonstrates how to use the `graft scaffold` command to generate a Graft manifest from existing Terraform modules.

## Scenario
You have an existing Terraform project with modules, and you want to start using Graft to modify one of them. Instead of writing the `manifest.graft.hcl` manually, you can use `graft scaffold` to discover modules and generate a starting point.

## Files
- `main.tf`: Standard Terraform configuration using a public registry module.

## Usage

1. **Initialize Terraform**  
   Modules must be downloaded for Graft to discover them.
   ```bash
   terraform init
   ```

2. **Scaffold a Manifest**  
   Run `graft scaffold` without arguments to see the module tree, and generate a manifest for all discovered modules.
   ```bash
   graft scaffold
   ```
   Output example:
   ```text
    [+] Discovering modules in .terraform/modules...
    root
    └── network (registry: registry.terraform.io/Azure/network/azurerm, 5.3.0)
        └── [3 resources]
    -> Tip: Run 'graft scaffold <MODULE_KEY>' to generate a manifest for a specific module.
    -> Example: graft scaffold linux_servers.os
    ✨ Manifest saved to ~/graft/examples/07-scaffold/manifest.graft.hcl
   ```
 
   If you want to scaffold only the `network` module, run:
   ```bash
   graft scaffold network
   ```

4. **Review the Generated Manifest**  
   Open `manifest.graft.hcl` to see the generated configuration. You can now add your customization logic inside the `module "network"` block.

    ```hcl

    # Generated by graft scaffold

    override {
    }
    module "network" {
      override {
        # resource "azurerm_virtual_network" "vnet" {}

        # resource "azurerm_subnet" "subnet_count" {}

        # resource "azurerm_subnet" "subnet_for_each" {}
      }
    }

    ```